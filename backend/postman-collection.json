{
  "info": {
    "name": "Azaya Backend API",
    "description": "Complete API collection for Azaya Document Management System",
    "version": "1.0.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "System",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/health",
              "host": ["{{baseUrl}}"],
              "path": ["health"]
            }
          }
        },
        {
          "name": "Server Status",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/",
              "host": ["{{baseUrl}}"],
              "path": [""]
            }
          }
        },
        {
          "name": "Cloudinary Config",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/config/cloudinary",
              "host": ["{{baseUrl}}"],
              "path": ["config", "cloudinary"]
            }
          }
        }
      ]
    },
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Register User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.token) {",
                  "        pm.environment.set('authToken', response.data.token);",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\",\n  \"role\": \"uploader\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "register"]
            }
          }
        },
        {
          "name": "Login User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.token) {",
                  "        pm.environment.set('authToken', response.data.token);",
                  "    }",
                  "}"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "login"]
            }
          }
        },
        {
          "name": "Get Profile",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/auth/profile",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "profile"]
            }
          }
        },
        {
          "name": "Update Profile",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Smith\",\n  \"email\": \"johnsmith@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/profile",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "profile"]
            }
          }
        },
        {
          "name": "Change Password",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"currentPassword\": \"password123\",\n  \"newPassword\": \"newpassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/change-password",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "change-password"]
            }
          }
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "Get All Users",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users?page=1&limit=10",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number for pagination"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Number of users per page"
                }
              ]
            }
          }
        },
        {
          "name": "Get User by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "User ID"
                }
              ]
            }
          }
        },
        {
          "name": "Get Users by Role",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/role/:role",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", "role", ":role"],
              "variable": [
                {
                  "key": "role",
                  "value": "uploader",
                  "description": "User role (uploader or signer)"
                }
              ]
            }
          }
        },
        {
          "name": "Create User",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"password\": \"password123\",\n  \"role\": \"uploader\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users"]
            }
          }
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Smith\",\n  \"email\": \"johnsmith@example.com\",\n  \"role\": \"signer\",\n  \"isActive\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "User ID"
                }
              ]
            }
          }
        },
        {
          "name": "Update User Password",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"currentPassword\": \"oldpassword123\",\n  \"newPassword\": \"newpassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/users/:id/password",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", ":id", "password"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "User ID"
                }
              ]
            }
          }
        },
        {
          "name": "Delete User",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/users/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "users", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "User ID"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "Documents",
      "item": [
        {
          "name": "Upload Document",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "document",
                  "type": "file",
                  "src": "",
                  "description": "PDF file to upload"
                },
                {
                  "key": "title",
                  "value": "Sample Contract",
                  "type": "text"
                },
                {
                  "key": "signerEmail",
                  "value": "signer@example.com",
                  "type": "text"
                },
                {
                  "key": "signatureFields",
                  "value": "[{\"type\": \"signature\", \"x\": 100, \"y\": 200, \"width\": 200, \"height\": 50, \"page\": 1, \"required\": true}]",
                  "type": "text",
                  "description": "JSON array of signature fields"
                },
                {
                  "key": "description",
                  "value": "Contract for software development services",
                  "type": "text",
                  "description": "Document description"
                },
                {
                  "key": "category",
                  "value": "contracts",
                  "type": "text",
                  "description": "Document category"
                },
                {
                  "key": "priority",
                  "value": "high",
                  "type": "text",
                  "description": "Document priority"
                },
                {
                  "key": "dueDate",
                  "value": "2024-12-31",
                  "type": "text",
                  "description": "Due date (YYYY-MM-DD)"
                },
                {
                  "key": "tags",
                  "value": "software,contract,development",
                  "type": "text",
                  "description": "Comma-separated tags"
                },
                {
                  "key": "department",
                  "value": "Engineering",
                  "type": "text",
                  "description": "Department"
                },
                {
                  "key": "project",
                  "value": "Project Alpha",
                  "type": "text",
                  "description": "Project name"
                },
                {
                  "key": "client",
                  "value": "Acme Corp",
                  "type": "text",
                  "description": "Client name"
                },
                {
                  "key": "custom_contractId",
                  "value": "CTR-2024-001",
                  "type": "text",
                  "description": "Custom field (starts with custom_)"
                },
                {
                  "key": "custom_value",
                  "value": "50000",
                  "type": "text",
                  "description": "Custom field for contract value"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/documents/upload",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", "upload"]
            }
          }
        },
        {
          "name": "Get All Documents",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/documents?page=1&limit=10&status=pending",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Documents per page"
                },
                {
                  "key": "status",
                  "value": "pending",
                  "description": "Filter by status (pending, signed, verified, rejected)"
                }
              ]
            }
          }
        },
        {
          "name": "Get Document by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/documents/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "Document ID"
                }
              ]
            }
          }
        },
        {
          "name": "Update Document",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Contract Title\",\n  \"signerEmail\": \"newsigner@example.com\",\n  \"signatureFields\": \"[{\\\"type\\\": \\\"signature\\\", \\\"x\\\": 150, \\\"y\\\": 250, \\\"width\\\": 250, \\\"height\\\": 60, \\\"page\\\": 1, \\\"required\\\": true}]\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/documents/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "Document ID"
                }
              ]
            }
          }
        },
        {
          "name": "Sign Document (with PDF)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "signatureImage",
                  "value": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==",
                  "type": "text",
                  "description": "Base64 signature image"
                },
                {
                  "key": "signerName",
                  "value": "John Doe",
                  "type": "text",
                  "description": "Signer name"
                },
                {
                  "key": "signerEmail",
                  "value": "john.doe@example.com",
                  "type": "text",
                  "description": "Signer email"
                },
                {
                  "key": "signedDate",
                  "value": "2024-01-15T10:30:00Z",
                  "type": "text",
                  "description": "Signing date (ISO string)"
                },
                {
                  "key": "status",
                  "value": "signed",
                  "type": "text",
                  "description": "Document status"
                },
                {
                  "key": "signedPdf",
                  "type": "file",
                  "src": "",
                  "description": "Signed PDF file (optional - replaces original)"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/api/documents/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "Document ID"
                }
              ]
            }
          }
        },
        {
          "name": "Sign Document (without PDF)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"signatureImage\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==\",\n  \"signerName\": \"John Doe\",\n  \"signerEmail\": \"john.doe@example.com\",\n  \"signedDate\": \"2024-01-15T10:30:00Z\",\n  \"status\": \"signed\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/documents/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "Document ID"
                }
              ]
            }
          }
        },
        {
          "name": "Get My Documents",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/documents/my-documents?page=1&limit=10&status=pending",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", "my-documents"],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Documents per page"
                },
                {
                  "key": "status",
                  "value": "pending",
                  "description": "Filter by status (pending, signed, verified, rejected)"
                }
              ]
            }
          }
        },
        {
          "name": "Get Documents by Uploader",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/documents/uploader/:uploaderId?page=1&limit=10&status=pending",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", "uploader", ":uploaderId"],
              "variable": [
                {
                  "key": "uploaderId",
                  "value": "",
                  "description": "Uploader User ID"
                }
              ],
              "query": [
                {
                  "key": "page",
                  "value": "1",
                  "description": "Page number"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Documents per page"
                },
                {
                  "key": "status",
                  "value": "pending",
                  "description": "Filter by status (pending, signed, verified, rejected)"
                }
              ]
            }
          }
        },
        {
          "name": "Delete Document",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/documents/:id",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", ":id"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "Document ID"
                }
              ]
            }
          }
        },
        {
          "name": "Update Document Status",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{authToken}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"verified\",\n  \"reason\": \"Document has been reviewed and approved\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/api/documents/:id/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "documents", ":id", "status"],
              "variable": [
                {
                  "key": "id",
                  "value": "",
                  "description": "Document ID"
                }
              ]
            },
            "description": "Update document status and reason. Status options: pending, signed, verified, rejected. Reason is required for rejected status."
          }
        }
      ]
    }
  ]
}
